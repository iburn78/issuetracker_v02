{% extends "blog/base.html" %}
{% load crispy_forms_tags %}
{% block content %}
    <div class="content-section">

	<form method="POST" enctype="multipart/form-data" autocomplete="off">
	    {% csrf_token %}
	    <fieldset class ="form-group">
			{{ form | crispy }}
	    </fieldset>
	    <div class="from-group">
			<button class="btn btn-info" type="submit">search</button>
			<a href={% url 'search-form' %} class="btn btn-outline-info float-right" role="button">clear</a>
	    </div>
	</form>
    </div>
	{% if search_requested == True %}
    {% if search_result_list %}
    	<div class="ml-2"><b>posts with "{{search_term}}" in title and content... </b><br/></div>
		<div class="border-top border-warning mt-1"> </div>
		<div class="border-top border-warning mb-1"> </div>
	    {% if level == "private" %}
        	{% for post in search_result_list %}
        		<div class="list_indent">
                	<a class="ml-2 mr-2" href="{% url 'privatepost-compact-list' user %}">{{ post.author }}</a>
    	    		<a class="article-title mt-2 mb-2 mr-3" href="{% url 'privatepost-detail' post.id %}">{{ post.title }}</a>
    				{% for tag in post.tags.all %}
    					<a href="{% url 'tag-privatepost-list' tag.id user %}" class="mr-1 mt-1">#{{ tag }}</a>
                	{% endfor %}
                	<small class="text-muted"> {{ post.date_posted|date:"M d, Y H:m" }}</small>
                	<br/>
    			</div> 
        	{% endfor %}
        {% else %}
        	{% for post in search_result_list %}
				<p>page number is {{ pgn_srl.page_range }}</p>
				<p>page tag number is {{ pgn_srl_tag.page_range }}</p>
				<p>page author number is {{ pgn_srl_author.page_range }}</p>
        		<div class="list_indent">
                	<a class="ml-2 mr-2" href="{% url 'user-post-list' post.author.username %}">{{ post.author }}</a>
    	    		<a class="article-title mt-2 mb-2 mr-3" href="{% url 'post-detail' post.id %}">{{ post.title }}</a>
    				{% for tag in post.tags.all %}
    					<a href="{% url 'tag-post-list' tag.id %}" class="mr-1 mt-1">#{{ tag }}</a>
                	{% endfor %}
                	<small class="text-muted"> {{ post.date_posted|date:"M d, Y H:m" }}</small>
                	<br/>
    			</div> 
        	{% endfor %}
	        <a class="btn btn-outline-info mb-4" href="?page=1&search_term={{search_term}}">page1</a>
	        <a class="btn btn-outline-info mb-4" href="?page=2&search_term={{search_term}}">page2</a>
	    {% endif %}
    {% elif search_term %}
    	<div style="color:#808080" class="ml-2"><i> search word "{{ search_term }}" not found in title and content </i><br/></div>
    {% endif %}
    <br/>


    {% if search_result_list_tag %}
    	<div class="ml-2"><b>posts with "{{search_term}}" in tags... </b><br/></div>
		<div class="border-top border-warning mt-1"> </div>
		<div class="border-top border-warning mb-1"> </div>
	    {% if level == "private" %}
        	{% for post in search_result_list_tag %}
        		<div class="list_indent">
                	<a class="ml-2 mr-2" href="{% url 'privatepost-compact-list' user %}">{{ post.author }}</a>
    	    		<a class="article-title mt-2 mb-2 mr-3" href="{% url 'privatepost-detail' post.id %}">{{ post.title }}</a>
    				{% for tag in post.tags.all %}
    					<a href="{% url 'tag-privatepost-list' tag.id user %}" class="mr-1 mt-1">#{{ tag }}</a>
                	{% endfor %}
                	<small class="text-muted"> {{ post.date_posted|date:"M d, Y H:m" }}</small>
                	<br/>
    			</div> 
        	{% endfor %}
        {% else %}
        {% for post in search_result_list_tag %}
        	<div class="list_indent">
                <a class="ml-2 mr-2" href="{% url 'user-post-list' post.author.username %}">{{ post.author }}</a>
    	    	<a class="article-title mt-2 mb-2 mr-3" href="{% url 'post-detail' post.id %}">{{ post.title }}</a>
    			{% for tag in post.tags.all %}
    				<a href="{% url 'tag-post-list' tag.id %}" class="mr-1 mt-1">#{{ tag }}</a>
                {% endfor %}
                <small class="text-muted"> {{ post.date_posted|date:"M d, Y H:m" }}</small>
                <br/>
    		</div> 
        {% endfor %}
	    {% endif %}
    {% elif search_term %}
    	<div style="color:#808080" class="ml-2"><i> search word "{{ search_term }}" not found in tags</i><br/></div>
    {% endif %}
    <br/>


	{% if level != "private" %}
    	{% if search_result_list_author %}
    		<div class="ml-2"><b>posts with "{{search_term}}" in author name... </b><br/></div>
			<div class="border-top border-warning mt-1"> </div>
			<div class="border-top border-warning mb-1"> </div>
        	{% for post in search_result_list_author %}
        		<div class="list_indent">
                	<a class="ml-2 mr-2" href="{% url 'user-post-list' post.author.username %}">{{ post.author }}</a>
    	    		<a class="article-title mt-2 mb-2 mr-3" href="{% url 'post-detail' post.id %}">{{ post.title }}</a>
    				{% for tag in post.tags.all %}
    					<a href="{% url 'tag-post-list' tag.id %}" class="mr-1 mt-1">#{{ tag }}</a>
                	{% endfor %}
                	<small class="text-muted"> {{ post.date_posted|date:"M d, Y H:m" }}</small>
                	<br/>
    			</div> 
        	{% endfor %}
	    {% elif search_term %}
    		<div style="color:#808080" class="ml-2"><i> search word "{{ search_term }}" not found in authors</i><br/></div>
	    {% endif %}
	{% endif %}
    <br/>
	{% endif %} 

{% endblock content %} 

